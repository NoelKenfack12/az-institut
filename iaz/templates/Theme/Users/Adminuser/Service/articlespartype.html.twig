{% extends "Theme/Users/Adminuser/layoutadmin.html.twig" %}
{% block meta %}
	{{ parent() }}
	<meta name="keywords" content="{{ site }}, Business, Innovation,Administration"/>
	<meta name="author" content="Noel Kenfack"/>
	<meta name="description" content="{{ site }} | Administration | Cameroun | {{ metier }}"/>
{% endblock %}

{% block title %}
	{{ parent() }} | Accueil Admin
{% endblock %}

{% block userblog_menuleft %}
	{{ render(controller("App\\Controller\\Users\\Adminuser\\AccueilController:menuadmin")) }}
{% endblock %}

{% block userblog_body %}

<div id="content">
	<div class="container">
	{% include 'Theme/General/Template/Menu/descriptionvariable.html.twig' %}
	<!--breadcrumbs start-->
<div class="inner-content">

<div class="col s12 m12 l6">
 <!--Borderless Table-->
<div class="section" style="padding: 5px 0px 0px 0px;">
<div class="row" style="background: #fafafa; border-bottom: 2px dashed #999;">
  <div class="col s12 m6 16">
	<h5 class="breadcrumbs-title">
		{{ 'Vous êtes ici'|trans }}:
	</h5>
	<ol class="breadcrumb">
	  <li><a href="{{ path('users_adminuser_accueil_administration') }}">{{ 'Administration'|trans }}</a></li>
	  <li class="active">Articles</li>
	  <li class="active">Toutes</li>
	</ol>
  </div>
</div>


<div class="row">
<div id="profile-page-sidebar" class="col s12 m12">
{% for infos in app.session.flashbag.get('information') %}
{% if loop.first %}
	{% include 'Theme/General/Template/Menu/flasinfos.html.twig' %}
{% endif %}
{% endfor %}

<div class="clearfix"></div>

{% set id = '' %}
{% for infos in app.session.flashbag.get('supprime_prod') %}
{% if loop.last %}
	<div class="card-panel" style="margin-top: 0px;">
		<strong style="color: red;"><span class="fa fa-warning"></span> Êtes vous certain de vouloir supprimer l'article {{ infos|lower }} </strong>
		<form action="{{ path('users_adminuser_supprimer_service_even',{'id': id }) }}" method="post">
		<input type="submit" value="Supprimer" style="background: red;"/>
		{{ form_rest(formsupp) }}
		</form>
	</div>
{% else %}
{% set id = infos %}
{% endif %}
{% endfor %}

{% set id = '' %}
{% for infos in app.session.flashbag.get('supprime_even') %}
{% if loop.last %}
	<div class="card-panel" style="margin-top: 0px;">
		<strong style="color: red;"><span class="fa fa-warning"></span> Êtes vous certain de vouloir supprimer l'article {{ infos|lower }} </strong>
		<form action="{{ path('users_adminuser_supprim_service_evenement',{'id': id }) }}" method="post">
		<input type="submit" value="Supprimer" style="background: red;"/>
		{{ form_rest(formsupp) }}
		</form>
	</div>
{% else %}
{% set id = infos %}
{% endif %}
{% endfor %}
</div>
</div>


<div class="row">
<div class="col s12 m12 14">
<main style="box-shadow:0px 0px 2px rgba(0,0,0,0.05); background: #fff;">
  {% for article in liste_article %}
  <div class="topic">
    <div class="open">
      <h2 class="question"><img src="{% if article.imgservice == null %}{{ asset('template/images/avatar.jpg') }}{% else %}{{ asset(article.imgservice.getWebPath) }}{% endif %}" alt="" style="width: 30px; height: 30px; margin-bottom: -8px!important;"/> 
		<span style="text-transform: capitalize;">{% if article.souscategorie != null %}{{ article.souscategorie.nom }}{% else %}{{ article.typearticle }}{% endif %}</span> <span class="mdi-hardware-keyboard-arrow-right" style="font-size: 12px;"></span>

	  {{ article.nom }}
	  
	  </h2>
      <span class="faq-t"></span>
    </div>
    <div class="answer">
		<div class="module-comment-block">
		<div>{{ article.description|raw }}</div>
		
		
		<ul id="dropdownarticle-{{ article.id }}" class="dropdown-content right" style="min-width: 250px;">
			<li>
				<a href="#!" class="update-content-article" value="{{ article.id }}"><i class="mdi-editor-border-color"></i> Modifier</a>
			</li>
			{% if article.typearticle == 'evenement' or article.typearticle == 'actualite' %}
			<li>
				<a href="#!" class="add_new_ressource" value="{{ article.id }}" name="video"><i class="mdi-communication-call-made"></i> Lier les vidéos</a>
			</li>
			<li>
				<a href="#!" class="add_new_ressource" value="{{ article.id }}" name="photo"><i class="mdi-communication-call-made"></i> Lier les photos</a>
			</li>
			{% endif %}
			<li>
				<a href="{{ path('users_adminuser_supprimer_service_even', {'id': article.id}) }}"><i class="mdi-action-highlight-remove"></i> Supprimer</a>
			</li>
		</ul>
		<a class="dropdown-button right" href="#!" data-activates="dropdownarticle-{{ article.id }}" style="position: absolute; right: 50px;"><i class="mdi-hardware-keyboard-control"></i></a>
		
		</div>
		
		<div class="clearfix"></div>
		<div style="display: block!important; width: 100%;">	
			{% if article.typearticle == 'evenement' or article.typearticle == 'actualite' %}
			<div class="clearfix"></div>
			<div style="display: block!important; width: 100%;">
				<h5>Liste des Ressources associées</h5>
				{% for ressource in article.ressourcearticles %}
				  <div class="tag {% if loop.index is odd %}blue{% else %}purple{% endif %}">
					  {% if ressource.type == 'galeriephoto' %}
						<a href="{% if ressource.ressource.type != null %}{{ path('produit_service_apropos_denous', {'idtype': ressource.ressource.type.id, 'idart': ressource.ressource.id, 'position': 'galeriephoto' }) }}{% else %}#!{% endif %}" style="color: #fff;">{{ ressource.ressource.nom }}</a>
					  {% else %}
						<a href="{% if ressource.ressource.type != null %}{{ path('produit_service_apropos_denous', {'idtype': ressource.ressource.type.id, 'idart': ressource.ressource.id, 'position': 'evenement' }) }}{% else %}#!{% endif %}" style="color: #fff;">{{ ressource.ressource.nom }}</a>
					  {% endif %}
					  <a href="" class="tag-exit">
						<i class="mdi-action-highlight-remove"></i>
					  </a>
				  </div>
				{% endfor %}
			</div>
			{% endif %}
			
			{{ render(controller("App\\Controller\\Produit\\Service\\ServiceController:listeparties", {'id': article.id })) }}
		</div>
	</div>
  </div>
  {% else %}
  <div class="topic">
    <div class="open">
		<h2 class="question">
			1. Aucun article publié pour cette catégorie
		</h2><span class="faq-t"></span>
    </div>
    <p class="answer">{% if typearticle != null %}La liste des articles de type {{ typearticle.nom }} s'affichera ici.{% else %}Aucune donnée disponible pour cette section{% endif %}</p>
  </div>
  {% endfor %}
</main>
</div>
</div>

<div class="clearfix"></div>
{% if nombrepage > 0 %}
			
{% if page > 1 and page <= nombrepage %}
{% set pagepre = page - 1 %}
{% else %}
	{% set pagepre = nombrepage %}
{% endif %}

{% if page < nombrepage %}
	{% set pagesuiv = page + 1 %}
{% else %}
	{% set pagesuiv =  1 %}
{% endif %}

{% if nombrepage < 5 %}
	{% set debut = 1 %}
	{% set fin = nombrepage %}
{% else %}
	{% if page > 2 and page < (nombrepage - 2) %}
		{% set debut = page - 2 %}
		{% if page + 2 >= nombrepage %}
			{% set fin = nombrepage %}
		{% else %}
			{% set fin = page + 2 %}
		{% endif %}
	{% else %}
		{% if page <= 2 %}
			{% if page == 1 %}
				{% set debut = 1 %}
				{% set fin = page + 3 %}
			{% else %}
				{% set debut = 1 %}
				{% set fin = page + 2 %}
			{% endif %}
		{% else %}
			{% set debut = page - 2 %}
			{% if page + 2 >= nombrepage %}
				{% set fin = nombrepage %}
			{% else %}
				{% set fin = page + 2 %}
			{% endif %}
		{% endif %}
	{% endif %}
	
{% endif %}

<div class="row" style="margin: 0px 0px 15px 0px; background: #f4f4f4; padding: 0px 0px 15px 0px;">
<div class="col s12 m12 32">
  <ul class="pagination">
	<li><a href="{{ path('users_adminuser_liste_article_type', {idtype: idtype, 'page': 1 }) }}" title="Première page" style=" width: 34px; height: 34px; border-radius: 17px; padding-left: 9px; padding-top: 9px;"><span class="mdi-av-fast-rewind"></span></a></li>
	<li><a href="{{ path('users_adminuser_liste_article_type', {idtype: idtype,  'page': pagepre }) }}" title="Page précedente" style=" width: 34px; height: 34px; border-radius: 17px; padding-left: 12px; padding-top: 9px;"><span class="mdi-av-skip-previous"></span></a></li>
	{% for p in debut..fin %}
	<li value="{{ p }}" class="{% if p == page %}active{% endif %}"><a href="{{ path('users_adminuser_liste_article_type', {idtype: idtype,  'page': p }) }}">{{ p }}</a></li>
	{% endfor %}
	<li><a href="{{ path('users_adminuser_liste_article_type', {idtype: idtype,  'page': pagesuiv }) }}"  title="Page suivante" style=" width: 34px; height: 34px; border-radius: 17px; padding-left: 12px; padding-top: 9px;"><span class="mdi-av-skip-next"></span></a></li>
	<li><a href="{{ path('users_adminuser_liste_article_type', {idtype: idtype,  'page': nombrepage }) }}" title="Dernière page" style=" width: 34px; height: 34px; border-radius: 17px; padding-left: 9px; padding-top: 9px;"><span class="mdi-av-fast-forward"></span></a></li>
   </ul>
</div>
</div>
<div class="clearfix"></div>
{% else %}
<div class="row" style="margin: 0px 0px 15px 0px; background: #f4f4f4; padding: 0px 0px 15px 0px;">
<div class="col s12 m12 32">
  <ul class="pagination">
  <li><a href="{{ path('users_adminuser_liste_article_type', {idtype: idtype,  'page': page }) }}" title="Première page" style=" width: 34px; height: 34px; border-radius: 17px; padding-left: 9px; padding-top: 9px;"><span class="mdi-av-fast-rewind"></span></a></li>
	<li><a href="{{ path('users_adminuser_liste_article_type', {idtype: idtype, 'page': page }) }}" title="Page précedente" style=" width: 34px; height: 34px; border-radius: 17px; padding-left: 12px; padding-top: 9px;"><span class="mdi-av-skip-previous"></span></a></li>

	<li  class="active"><a href="{{ path('users_adminuser_liste_article_type', {idtype: idtype, 'page': 1 }) }}">0</a></li>

	<li><a href="{{ path('users_adminuser_liste_article_type', {idtype: idtype, 'page': page }) }}"  title="Page suivante" style=" width: 34px; height: 34px; border-radius: 17px; padding-left: 12px; padding-top: 9px;"><span class="mdi-av-skip-next"></span></a></li>
	<li><a href="{{ path('users_adminuser_liste_article_type', {idtype: idtype, 'page': page }) }}" title="Dernière page" style=" width: 34px; height: 34px; border-radius: 17px; padding-left: 9px; padding-top: 9px;"><span class="mdi-av-fast-forward"></span></a></li>
  </ul>
</div>
</div>
<div class="clearfix"></div>
{% endif %}	

</div>
</div>
</div>
</div>
</div>


<div class="modal fade" data-backdrop="false"  id="modalGestionCatalogueSelect" style="margin-top: 60px;">
<div class="modal-dialog">
<div class="modal-content" style="padding: 0px; border-radius: 0px;">
<nav class="red" style="background: #3565ae!important;">
<h5 style="padding-top: 20px; padding-left: 4px;">
  <i class="mdi-hardware-keyboard-alt"></i> Modifier article <button type="button" class="close right" data-dismiss="modal"><i class="mdi-content-clear modal-action  modal-close"></i></button>
</h5>
</nav>
<div class="modal-body">
<div class="row">
	<div class="row">
	  <div class="input-field col s12">
		<div class="wait-chargement-content-module" style="text-align: center;">
			Patientez un moment pendant le chargement de l'article</br>
			<img src="{{ asset('template/images/loader1.gif') }}" alt="image" style="height: 40px; width: 40px;">
		</div>

		<div class="content-module-loading" style="display: none;">
		
		</div>
	  </div>
	</div>
</div>
</div>

<div class="modal-footer" style="border-top: 1px solid #ddd;">
	{% include 'Theme/General/Template/Menu/social.html.twig' %}
</div>

</div>
</div>
</div>	
{% endblock %}

{% block javascripttemplate %}
$('.select_multiple').show();
	
$('.update-content-article').click(function(){
	var id = $(this).attr('value');
	$('#modalGestionCatalogueSelect').modal('show');
	$('.wait-chargement-content-module').show();
	$('.content-module-loading').hide();
	$.get('{{ path('users_adminuser_modifier_un_service') }}',{ id: id }, function(data){
		$('.wait-chargement-content-module').hide();
		$('.content-module-loading').show();
		$('.content-module-loading').html(data);
	});
});	
$('.add_new_ressource').click(function(){
	var id = $(this).attr('value');
	var name = $(this).attr('name');
	$('#modalGestionCatalogueSelect').modal('show');
	$('.wait-chargement-content-module').show();
	$('.content-module-loading').hide();
	$.get('{{ path('users_adminuser_add_new_ressource_article') }}',{ id: id, name: name }, function(data){
		$('.wait-chargement-content-module').hide();
		$('.content-module-loading').show();
		$('.content-module-loading').html(data);
	});
});

$('.update-content-partie-article').click(function(){
	var id = $(this).attr('value');
	$('#modalGestionCatalogueSelect').modal('show');
	$('.wait-chargement-content-module').show();
	$('.content-module-loading').hide();
	
	$.get('{{ path('users_adminuser_service_modifier_evenement_service') }}', { id: id }, function(data){
		$('.wait-chargement-content-module').hide();
		$('.content-module-loading').show();
		$('.content-module-loading').html(data);
	});
});

$(".open").click(function(){
  var container = $(this).parents(".topic");
  var answer = container.find(".answer");
  var trigger = container.find(".faq-t");
  
  answer.slideToggle(200);
  
  if (trigger.hasClass("faq-o")) {
    trigger.removeClass("faq-o");
  }
  else {
    trigger.addClass("faq-o");
  }
  
  if (container.hasClass("expanded")) {
    container.removeClass("expanded");
  }
  else {
    container.addClass("expanded");
  }
});
{% endblock %}